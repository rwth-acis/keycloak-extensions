{"version":3,"sources":["../../../src/app/content/device-activity-page/DeviceActivityPage.tsx"],"names":["React","AccountServiceContext","TimeUtil","Bullseye","DataList","DataListItem","DataListItemRow","DataListCell","DataListItemCells","Grid","GridItem","Stack","StackItem","AmazonIcon","ChromeIcon","EdgeIcon","FirefoxIcon","GlobeIcon","InternetExplorerIcon","OperaIcon","SafariIcon","YandexInternationalIcon","Msg","ContinueCancelModal","KeycloakContext","ContentPage","ContentAlert","DeviceActivityPage","Component","constructor","props","context","keycloakService","doDelete","then","logout","device","session","id","fetchDevices","success","browser","os","state","devices","doGet","response","console","log","moveCurrentToTop","data","setState","currentDevice","forEach","index","current","splice","unshift","sessions","currentSession","time","format","elementId","item","substring","findBrowserIcon","browserName","toLowerCase","includes","startsWith","findOS","localize","findOSVersion","osVersion","makeClientsString","clients","clientsString","client","clientName","hasOwnProperty","undefined","clientId","length","isShowSignOutAll","render","bind","keycloak","signOutAll","map","deviceIndex","sessionIndex","ipAddress","lastAccess","started","expires","signOutSession"],"mappings":"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","sourcesContent":["/*\r\n * Copyright 2018 Red Hat, Inc. and/or its affiliates.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport * as React from 'react';\r\n\r\nimport {HttpResponse} from '../../account-service/account.service';\r\nimport { AccountServiceContext } from '../../account-service/AccountServiceContext';\r\nimport TimeUtil from '../../util/TimeUtil';\r\n\r\nimport {\r\n  Bullseye,\r\n  DataList,\r\n  DataListItem,\r\n  DataListItemRow,\r\n  DataListCell,\r\n  DataListItemCells,\r\n  Grid,\r\n  GridItem,\r\n  Stack,\r\n  StackItem\r\n} from '@patternfly/react-core';\r\n\r\nimport {\r\n        AmazonIcon,\r\n        ChromeIcon,\r\n        EdgeIcon,\r\n        FirefoxIcon,\r\n        GlobeIcon,\r\n        InternetExplorerIcon,\r\n        OperaIcon,\r\n        SafariIcon,\r\n        YandexInternationalIcon,\r\n} from '@patternfly/react-icons';\r\n\r\nimport {Msg} from '../../widgets/Msg';\r\nimport {ContinueCancelModal} from '../../widgets/ContinueCancelModal';\r\nimport { KeycloakService } from '../../keycloak-service/keycloak.service';\r\nimport { KeycloakContext } from '../../keycloak-service/KeycloakContext';\r\n\r\nimport {ContentPage} from '../ContentPage';\r\nimport { ContentAlert } from '../ContentAlert';\r\n\r\nexport interface DeviceActivityPageProps {\r\n}\r\n\r\nexport interface DeviceActivityPageState {\r\n  devices: Device[];\r\n}\r\n\r\ninterface Device {\r\n  browser: string;\r\n  current: boolean;\r\n  device: string;\r\n  ipAddress: string;\r\n  lastAccess: number;\r\n  mobile: boolean;\r\n  os: string;\r\n  osVersion: string;\r\n  sessions: Session[];\r\n}\r\n\r\ninterface Session {\r\n  browser: string;\r\n  current: boolean;\r\n  clients: Client[];\r\n  expires: number;\r\n  id: string;\r\n  ipAddress: string;\r\n  lastAccess: number;\r\n  started: number;\r\n}\r\n\r\ninterface Client {\r\n  clientId: string;\r\n  clientName: string;\r\n}\r\n\r\n/**\r\n * @author Stan Silvert ssilvert@redhat.com (C) 2019 Red Hat Inc.\r\n */\r\nexport class DeviceActivityPage extends React.Component<DeviceActivityPageProps, DeviceActivityPageState> {\r\n    static contextType = AccountServiceContext;\r\n    context: React.ContextType<typeof AccountServiceContext>;\r\n\r\n    public constructor(props: DeviceActivityPageProps, context: React.ContextType<typeof AccountServiceContext>) {\r\n        super(props);\r\n        this.context = context;\r\n\r\n        this.state = {\r\n          devices: []\r\n        };\r\n\r\n        this.fetchDevices();\r\n    }\r\n\r\n    private signOutAll = (keycloakService: KeycloakService) => {\r\n      this.context!.doDelete(\"/sessions\")\r\n        .then( () => {\r\n          keycloakService.logout();\r\n        });\r\n    }\r\n\r\n    private signOutSession = (device: Device, session: Session) => {\r\n      this.context!.doDelete(\"/sessions/\" + session.id)\r\n          .then (() => {\r\n            this.fetchDevices();\r\n            ContentAlert.success('signedOutSession', [session.browser, device.os]);\r\n          });\r\n    }\r\n\r\n    private fetchDevices(): void {\r\n      this.context!.doGet<Device[]>(\"/sessions/devices\")\r\n          .then((response: HttpResponse<Device[]>) => {\r\n            console.log({response});\r\n\r\n            let devices: Device[] = this.moveCurrentToTop(response.data as Device[]);\r\n\r\n            this.setState({\r\n              devices: devices\r\n            });\r\n\r\n          });\r\n    }\r\n\r\n    // current device and session should display at the top of their respective lists\r\n    private moveCurrentToTop(devices: Device[]): Device[] {\r\n      let currentDevice: Device = devices[0];\r\n\r\n      devices.forEach((device: Device, index: number) => {\r\n        if (device.current) {\r\n          currentDevice = device;\r\n          devices.splice(index, 1);\r\n          devices.unshift(device);\r\n        }\r\n      });\r\n\r\n      currentDevice.sessions.forEach((session: Session, index: number) => {\r\n        if (session.current) {\r\n          const currentSession: Session[] = currentDevice.sessions.splice(index, 1);\r\n          currentDevice.sessions.unshift(currentSession[0]);\r\n        }\r\n      });\r\n\r\n      return devices;\r\n    }\r\n\r\n    private time(time: number): string {\r\n      return TimeUtil.format(time * 1000);\r\n    }\r\n\r\n    private elementId(item: string, session: Session): string {\r\n        return `session-${session.id.substring(0,7)}-${item}`;\r\n    }\r\n\r\n    private findBrowserIcon(session: Session): React.ReactNode {\r\n      const browserName: string = session.browser.toLowerCase();\r\n      if (browserName.includes(\"chrom\")) return (<ChromeIcon id={this.elementId('icon-chrome', session)} size='lg'/>); // chrome or chromium\r\n      if (browserName.includes(\"firefox\")) return (<FirefoxIcon id={this.elementId('icon-firefox', session)} size='lg'/>);\r\n      if (browserName.includes(\"edge\")) return (<EdgeIcon id={this.elementId('icon-edge', session)} size='lg'/>);\r\n      if (browserName.startsWith(\"ie/\")) return (<InternetExplorerIcon id={this.elementId('icon-ie', session)} size='lg'/>);\r\n      if (browserName.includes(\"safari\")) return (<SafariIcon id={this.elementId('icon-safari', session)} size='lg'/>);\r\n      if (browserName.includes(\"opera\")) return (<OperaIcon id={this.elementId('icon-opera', session)} size='lg'/>);\r\n      if (browserName.includes(\"yandex\")) return (<YandexInternationalIcon id={this.elementId('icon-yandex', session)} size='lg'/>);\r\n      if (browserName.includes(\"amazon\")) return (<AmazonIcon id={this.elementId('icon-amazon', session)} size='lg'/>);\r\n\r\n      return (<GlobeIcon id={this.elementId('icon-default', session)} size='lg'/>);\r\n    }\r\n\r\n    private findOS(device: Device): string {\r\n      if (device.os.toLowerCase().includes('unknown')) return Msg.localize('unknownOperatingSystem');\r\n\r\n      return device.os;\r\n    }\r\n\r\n    private findOSVersion(device: Device): string {\r\n      if (device.osVersion.toLowerCase().includes('unknown')) return '';\r\n\r\n      return device.osVersion;\r\n    }\r\n\r\n    private makeClientsString(clients: Client[]): string {\r\n      let clientsString = \"\";\r\n      clients.forEach( (client: Client, index: number) => {\r\n        let clientName: string;\r\n        if (client.hasOwnProperty('clientName') && (client.clientName !== undefined) && (client.clientName !== '')) {\r\n          clientName = Msg.localize(client.clientName);\r\n        } else {\r\n          clientName = client.clientId;\r\n        }\r\n\r\n        clientsString += clientName;\r\n\r\n        if (clients.length > index + 1) clientsString += ', ';\r\n      })\r\n\r\n      return clientsString;\r\n    }\r\n\r\n    private isShowSignOutAll(devices: Device[]): boolean {\r\n      if (devices.length === 0) return false;\r\n      if (devices.length > 1) return true;\r\n      if (devices[0].sessions.length > 1) return true;\r\n\r\n      return false;\r\n    }\r\n\r\n    public render(): React.ReactNode {\r\n\r\n      return (\r\n        <ContentPage title=\"device-activity\" onRefresh={this.fetchDevices.bind(this)}>\r\n          <Stack gutter=\"md\">\r\n            <StackItem isFilled>\r\n              <DataList aria-label={Msg.localize('signedInDevices')}>\r\n                  <DataListItem key=\"SignedInDevicesHeader\" aria-labelledby=\"signedInDevicesTitle\" isExpanded={false}>\r\n                      <DataListItemRow>\r\n                          <DataListItemCells\r\n                              dataListCells={[\r\n                                <DataListCell key='signedInDevicesTitle' width={4}>\r\n                                  <div id=\"signedInDevicesTitle\" className=\"pf-c-content\">\r\n                                      <h2><Msg msgKey=\"signedInDevices\"/></h2>\r\n                                      <p>\r\n                                          <Msg msgKey=\"signedInDevicesExplanation\"/>\r\n                                      </p>\r\n                                  </div>\r\n                                </DataListCell>,\r\n                                <KeycloakContext.Consumer>\r\n                                { (keycloak: KeycloakService) => (\r\n                                  <DataListCell key='signOutAllButton' width={1}>\r\n                                    {this.isShowSignOutAll(this.state.devices) &&\r\n                                      <ContinueCancelModal buttonTitle='signOutAllDevices'\r\n                                                    buttonId='sign-out-all'\r\n                                                    modalTitle='signOutAllDevices'\r\n                                                    modalMessage='signOutAllDevicesWarning'\r\n                                                    onContinue={() => this.signOutAll(keycloak)}\r\n                                      />\r\n                                    }\r\n                                  </DataListCell>\r\n                                )}\r\n                                </KeycloakContext.Consumer>\r\n                              ]}\r\n                          />\r\n                      </DataListItemRow>\r\n                  </DataListItem>\r\n\r\n                  <DataListItem aria-labelledby='sessions'>\r\n                  <DataListItemRow>\r\n                    <Grid gutter='sm'>\r\n                      <GridItem span={12} /> {/* <-- top spacing */}\r\n                      {this.state.devices.map((device: Device, deviceIndex: number) => {\r\n                        return (\r\n                          <React.Fragment>\r\n                            {device.sessions.map((session: Session, sessionIndex: number) => {\r\n                              return (\r\n                                <React.Fragment key={'device-' + deviceIndex + '-session-' + sessionIndex}>\r\n\r\n                                  <GridItem md={3}>\r\n                                    <Stack>\r\n                                      <StackItem isFilled={false}>\r\n                                        <Bullseye>{this.findBrowserIcon(session)}</Bullseye>\r\n                                      </StackItem>\r\n                                      <StackItem isFilled={false}>\r\n                                        <Bullseye id={this.elementId('ip', session)}>{session.ipAddress}</Bullseye>\r\n                                      </StackItem>\r\n                                      {session.current &&\r\n                                        <StackItem isFilled={false}>\r\n                                          <Bullseye id={this.elementId('current-badge', session)}><strong className='pf-c-badge pf-m-read'><Msg msgKey=\"currentSession\" /></strong></Bullseye>\r\n                                        </StackItem>\r\n                                      }\r\n                                    </Stack>\r\n                                  </GridItem>\r\n                                  <GridItem md={9}>\r\n                                  {!session.browser.toLowerCase().includes('unknown') &&\r\n                                    <p id={this.elementId('browser', session)}><strong>{session.browser} / {this.findOS(device)} {this.findOSVersion(device)}</strong></p>}\r\n                                    <p id={this.elementId('last-access', session)}><strong>{Msg.localize('lastAccessedOn')}</strong> {this.time(session.lastAccess)}</p>\r\n                                    <p id={this.elementId('clients', session)}><strong>{Msg.localize('clients')}</strong> {this.makeClientsString(session.clients)}</p>\r\n                                    <p id={this.elementId('started', session)}><strong>{Msg.localize('startedAt')}</strong> {this.time(session.started)}</p>\r\n                                    <p id={this.elementId('expires', session)}><strong>{Msg.localize('expiresAt')}</strong> {this.time(session.expires)}</p>\r\n                                    {!session.current &&\r\n                                      <ContinueCancelModal buttonTitle='doSignOut'\r\n                                        buttonId={this.elementId('sign-out', session)}\r\n                                        modalTitle='doSignOut'\r\n                                        buttonVariant='secondary'\r\n                                        modalMessage='signOutWarning'\r\n                                        onContinue={() => this.signOutSession(device, session)}\r\n                                      />\r\n                                    }\r\n\r\n                                  </GridItem>\r\n                                </React.Fragment>\r\n                              );\r\n\r\n                            })}\r\n                          </React.Fragment>\r\n                        )\r\n                      })}\r\n                      <GridItem span={12} /> {/* <-- bottom spacing */}\r\n                    </Grid>\r\n                  </DataListItemRow>\r\n                </DataListItem>\r\n              </DataList>\r\n            </StackItem>\r\n\r\n          </Stack>\r\n        </ContentPage>\r\n        );\r\n    }\r\n};"],"file":"DeviceActivityPage.js"}